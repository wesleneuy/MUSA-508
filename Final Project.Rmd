---
title: "Final Project"
author: "Me"
date: "12/7/2021"
output: html_document
---
```{r load packages}
library(sf)
library(lubridate)
library(tigris)
library(tidycensus)
library(viridis)
library(riem)
library(gridExtra)
library(knitr)
library(kableExtra)
library(readxl)
library(gganimate)
library(FNN)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(RSocrata)
#library(nngeo)
#install.packages("spatialEco")
#library(spatialEco)
library(sp)
library(jtools)
library(stringr)
library(ggcorrplot)
#library(Hmisc)
#library(car)
library(stargazer)
#library(mlogit)
#library(huxtable)
library(plotROC)
#library(ROCR)
#library(pROC)
library(RSocrata)
library(glue)
library(rjson)
plotTheme <- function(base_size = 12) {
  theme(
    text = element_text( color = "black"),
    plot.title = element_text(size = 14,colour = "black"),
    plot.subtitle = element_text(face="italic"),
    plot.caption = element_text(hjust=0),
    axis.ticks = element_blank(),
    panel.background = element_blank(),
    panel.grid.major = element_line("grey80", size = 0.1),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    strip.background = element_rect(fill = "grey80", color = "white"),
    strip.text = element_text(size=12),
    axis.title = element_text(size=12),
    axis.text = element_text(size=10),
    plot.background = element_blank(),
    legend.background = element_blank(),
    legend.title = element_text(colour = "black", face = "italic"),
    legend.text = element_text(colour = "black", face = "italic"),
    strip.text.x = element_text(size = 14)
  )
}
mapTheme <- function(base_size = 12) {
  theme(
    text = element_text( color = "black"),
    plot.title = element_text(size = 16,colour = "black"),
    plot.subtitle=element_text(face="italic"),
    plot.caption=element_text(hjust=0),
    axis.ticks = element_blank(),
    panel.background = element_blank(),axis.title = element_blank(),
    axis.text = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    strip.text.x = element_text(size = 14))
}
nn_function <- function(measureFrom,measureTo,k) {
  measureFrom_Matrix <- as.matrix(measureFrom)
  measureTo_Matrix <- as.matrix(measureTo)
  nn <-   
    get.knnx(measureTo, measureFrom, k)$nn.dist
  output <-
    as.data.frame(nn) %>%
    rownames_to_column(var = "thisPoint") %>%
    gather(points, point_distance, V1:ncol(.)) %>%
    arrange(as.numeric(thisPoint)) %>%
    group_by(thisPoint) %>%
    dplyr::summarize(pointDistance = mean(point_distance)) %>%
    arrange(as.numeric(thisPoint)) %>%
    dplyr::select(-thisPoint) %>%
    pull()
  return(output)  
}
```


```{r parking data setup, include=FALSE}
#SF Data 

meter <- st_read("https://data.sfgov.org/api/geospatial/8vzz-qzz9?method=export&format=GeoJSON") %>% 
  st_as_sf(coords = c("longitude", "latitude"), crs = 4326, agr = "constant")%>%
  st_transform(crs = st_crs('EPSG:7131'))

st_geometry(meter) <- NULL
 meter1 <- meter%>% st_set_geometry()
   
   dplyr::select(latitude, post_id, longitude, street_name, meter_type, blockface_id)

parking <- read.csv("~/GitHub/MUSA-508/SFMTA_Parking_Meter_Detailed_Revenue_Transactions.csv")

parking2 <- 
  parking %>%
  mutate(interval60 = floor_date(ymd_hms(SESSION_START_DT), unit = "hour"),
         interval15 = floor_date(ymd_hms(SESSION_START_DT), unit = "15 mins"),
         hour = hour(interval60),
         week = week(interval60),
         dotw = wday(interval60, label=TRUE)) 

#get start and end difference, duration for each meter

parking2 <- parking2 %>% mutate(duration = difftime(ymd_hms(SESSION_END_DT), ymd_hms(SESSION_START_DT), unit = "mins"))

#count and average duration by meter
meter_count <- 
  parking2 %>%
   mutate(pk_Counter = 1) %>%
  group_by(POST_ID) %>%
  dplyr::summarize(mean_dur = mean(duration),
                   mean_paid = mean(GROSS_PAID_AMT),
                    pk_Count = sum(pk_Counter, na.rm=T),
                   week = unique(week))

meter_count <- meter_count %>% rename (post_id = POST_ID)


#count by block
#block_count <- 
 # parking2 %>%
 # mutate(pk_Counter = 1) %>%
 # group_by(STREET_BLOCK) %>%
 # dplyr::summarize(pk_Count = sum(pk_Counter, na.rm=T))

#merge with parking meter data 
meter_count_info <- merge(x = meter_count, y = meter, by = "post_id", all.x=TRUE)

meter_count_info%>% na.omit() %>%
  st_as_sf(coords = c("longitude", "latitude"), crs = 4326, agr = "constant")%>%
  st_transform(st_crs('EPSG:7131'))


#count and average duration by meter and dotw
meter_count_dotw <- 
  parking2 %>%
  mutate(pk_Counter = 1) %>%
  group_by(POST_ID, dotw) %>%
  dplyr::summarize(mean_dur = mean(duration),
                   mean_paid = mean(GROSS_PAID_AMT),
                   pk_Count = sum(pk_Counter, na.rm=T))

meter_count_dotw <- meter_count_dotw %>% rename (post_id = POST_ID)

#merge by meter and dotw with parking meter data
meter_count_dotw_info <- merge(x = meter_count_dotw, y = meter, by = "post_id", all.x=TRUE)


#meter_panel.sf <- st_as_sf(na.omit(meter_count_info), coords = c("longitude", "latitude"), crs = "+proj=longlat +crs = 'EPSG:6339'", agr = "constant")

#meter.sf <- st_as_sf(na.omit(meter), coords = c("LONGITUDE", "LATITUDE"), crs = "+proj=longlat +crs = 'EPSG:6339'", agr = "constant")

#meter_panel.sf <- meter_count_info %>% na.omit() %>%
 # st_as_sf(coords = c("LONGITUDE", "LATITUDE"), crs = "+proj=longlat +crs = 'EPSG:6339'", agr = "constant") 

#meter_dotw_panel.sf <- st_as_sf(na.omit(meter_count_dotw_info), coords = c("LONGITUDE", #"LATITUDE"), crs = "+proj=longlat +crs = 'EPSG:6339'")


```
#parking transactions by dotw
parking3 <- filter(parking2, hour > 9 & hour < 18) %>% filter(dotw != "Sun")

ggplot(parking3)+
  geom_freqpoly(aes(hour, color = dotw), binwidth = 1)+
  labs(title="Parking Transactions",
       subtitle = "Summer 2019",
       x="Hour", 
       y="Transaction Counts")+
  plotTheme()

#mean number of transactions per station
parking2 %>%
  mutate(time_of_day = case_when(hour(interval60) < 7 | hour(interval60) > 18 ~ "Overnight",
                                 hour(interval60) >= 7 & hour(interval60) < 10 ~ "AM Rush",
                                 hour(interval60) >= 10 & hour(interval60) < 15 ~ "Mid-Day",
                                 hour(interval60) >= 15 & hour(interval60) <= 18 ~ "PM Rush"))%>%
  group_by(interval60, POST_ID, time_of_day) %>%
  tally()%>%
  group_by(POST_ID, time_of_day)%>%
  summarize(mean_trips = mean(n))%>%
  ggplot()+
  geom_histogram(aes(mean_trips), binwidth = 1)+
  labs(title="Mean Number of Hourly Trips Per Station",
       subtitle="Philadelphia, October 8th - November 11st, 2019",
       x="Number of trips", 
       y="Frequency")+
  facet_wrap(~time_of_day)+
  plotTheme()

#plot 3
ggplot(parking2 %>%
         group_by(interval60, POST_ID) %>%
         tally())+
  geom_histogram(aes(n), binwidth = 5)+
  labs(title="Bike share trips per hr by station",
       subtitle = "Philadelphia, October 8th - November 11st, 2019",
       x="Trip Counts", 
       y="Number of Stations")+
  plotTheme()



```{r external data setup}
#------------is it an arterial street? ---------------
arterial <- st_read("https://data.sfgov.org/api/geospatial/gnsq-9x5h?method=export&format=GeoJSON") %>%
    mutate(Legend = "streets") %>% dplyr::select(streetname, geometry, Legend)%>%
  st_transform(st_crs('EPSG:7131'))

arterialbuffer <- st_buffer(arterial, 1) %>% st_union()
   
 st_union(st_buffer(arterial, 1)) %>%
      st_sf()

wildfires <-
 wildfires %>%
 mutate(wildfire = 1)

boulder.sf <-
  st_join(boulder.sf, wildfires) 

boulder.sf$wildfires =
  ifelse(is.na(boulder.sf$wildfire),0, 1)

#------------distance from downtown ------------------
neighborhoods <- st_read("https://data.sfgov.org/api/geospatial/pty2-tcw4?method=export&format=GeoJSON")%>% mutate(Legend = "neighborhoods") %>%
  st_transform(st_crs('EPSG:7131'))

#list of neighborhoods

downtown <- c("Downtown / Union Square",
           "Chinatown",
           "Nob Hill",
           "Lower Nob Hill",
           "North Beach",
           "South of Market",
           "Financial District",
           "Civic Center",
           "Mission",
           "Mission Dolores",
           "Mission Bay",
           #"Inner Sunset",
           "Russian Hill")
#just plotting
ggplot() +
  geom_sf(data = downtown, fill = "grey90") +
  geom_sf_label(data = downtown, aes(label = name), size = 3) +
  mapTheme()

#get the union 
downtown <- filter(neighborhoods, name %in% downtown)

downtown_union <- st_union(downtown)
downtown.sf <- st_centroid(downtown_union)


#-----------distance from off street parking----------
garage <- st_read("https://data.sfgov.org/api/geospatial/vqzx-t7c4?method=export&format=GeoJSON") %>% mutate(Legend = "garage") %>% dplyr::select(geometry) %>%
  na.omit()%>%
  st_transform(st_crs('EPSG:7131'))

#-----------distance from transit stops---------------
transitstops <- st_read("~/GitHub/MUSA-508/transitstops.geojson") %>% mutate(Legend = "transit") %>% st_transform(st_crs('EPSG:7131'))

transitstops <- filter(transitstops, agency_id == "SF")

#------------landuse----------------------------------
landuse <- st_read("https://data.sfgov.org/api/geospatial/us3s-fp9q?method=export&format=GeoJSON") %>% st_transform(st_crs('EPSG:7131'))

retail <- landuse %>% filter(., landuse == "RETAIL/ENT") %>% mutate(Legend = "dum_retail")

cultural <- landuse %>% filter(., landuse == "CIE") %>% mutate(Legend = "dum_culture") 

medical <- landuse %>% filter(., landuse == "MED") %>% mutate(Legend = "dum_med")

visitor <- landuse %>% filter(., landuse == "VISITOR") %>% mutate(Legend = "dum_vis")

#------------count of businesses -----------------------
reg_business <- st_read("https://data.sfgov.org/api/geospatial/g8m3-pdis?method=export&format=GeoJSON") %>% mutate(Legend = "business") %>% st_transform(st_crs('EPSG:7131')) %>% na.omit()

#Arts entertainment and recreation
retail_count <- reg_business %>% filter(., reg_business == "RETAIL/ENT") %>% mutate(Legend = "dum_retail")

#Food services
retail <- reg_business %>% filter(., reg_business == "RETAIL/ENT") %>% mutate(Legend = "dum_retail")

#Retail Trade
retail <- reg_business %>% filter(., reg_business == "RETAIL/ENT") %>% mutate(Legend = "count_retail")


crash_net = 
  dplyr::select(traffic_crash) %>%
  mutate(traffic_crash_count = 1) %>%
  aggregate(., fishnet, sum) %>%
  mutate(traffic_crash_count = replace_na(traffic_crash_count, 0),
         uniqueID = rownames(.),
         cvID = sample(round(nrow(fishnet) / 24), 
                       size=nrow(fishnet), replace = TRUE))


  
```

Nearest neighbors
```{r data setup}
st_c <- st_coordinates
st_coid <- st_centroid

#garage, transit stop, downtown.sf

vars_nn <-
  meter_count_info %>%
    mutate(downtown.nn =
        nn_function(st_c(meter_count_info), st_c(downtown.sf),1),
      transit.nn =
        nn_function(st_c(meter_count_info), st_c(transitstops),1),
      garage.nn =
        nn_function(st_c(meter_count_info), st_c(garage),3)) %>%
  st_transform(st_crs('EPSG:7131'))


vars_dummy <-
 meter_count_dotw_info  %>%
    mutate(
      retail = ifelse(st_intersects(study_panel.sf, retail), 1, 0),
      retail = ifelse(is.na(retail)==T, 0, pdr),
      cultural = ifelse(st_intersects(study_panel.sf, cultural), 1, 0),
      cultural = ifelse(is.na(cultural)==T, 0, cultural),
      medical = ifelse(st_intersects(study_panel.sf, medical), 1, 0),
      medical = ifelse(is.na(medical)==T, 0, medical),
      visitor = ifelse(st_intersects(study_panel.sf, visitor), 1, 0),
      visitor = ifelse(is.na(visitor)==T, 0, visitor),
    )

vars_dummy <-
  vars_dummy %>%
  select(POST_ID, dotw, retail, cultural, medical, visitor)

```

```{r census data setup}
census_api_key("7fcf0c60997f4d8ccd298e26df0b2f35dc033150",install=TRUE, overwrite=TRUE)

SFCensus <- 
  get_acs(geography = "tract", 
          variables = c("B01003_001", "B19013_001", 
                        "B02001_002", "B08013_001",
                        "B08012_001", "B08301_001", 
                        "B08301_010", "B01002_001"), 
          year = 2019, 
          state = 06,
          county= 075,
          geometry = TRUE, 
          output = "wide") %>%
  dplyr::rename(Total_Pop =  B01003_001E,
         Med_Inc = B19013_001E,
         Med_Age = B01002_001E,
         White_Pop = B02001_002E,
         Travel_Time = B08013_001E,
         Num_Commuters = B08012_001E,
         Means_of_Transport = B08301_001E,
         Total_Public_Trans = B08301_010E) %>%
  dplyr::select(Total_Pop, Med_Inc, White_Pop, Travel_Time, 
         Means_of_Transport, Total_Public_Trans,
         Med_Age,
         GEOID, geometry) %>%
  mutate(Percent_White = White_Pop / Total_Pop,
         Mean_Commute_Time = Travel_Time / Total_Public_Trans,
         Percent_Taking_Public_Trans = Total_Public_Trans / Means_of_Transport)


SFTracts <-
  SFCensus %>%
  as.data.frame() %>%
  distinct(GEOID, .keep_all = TRUE) %>%
  st_sf %>%
  st_transform(st_crs(6339))

#-------------joining census tracts to the parking data-----------------
dat_census <- st_join(meter_count_info,
        SFTracts %>% st_transform(st_crs('EPSG:7131')
          st_transform(crs = "+proj=longlat +crs = 'EPSG:6339'"),
        join=st_intersects,
              left = TRUE) %>%
  rename(Origin.Tract = GEOID) %>%
  mutate(LONGITUDE = unlist(map(geometry, 1)),
         LATITUDE = unlist(map(geometry, 2)))

dat_census <-
  dat_census %>%
  select()

#-----------Census Median Income-----------------------
ggplot()+
  geom_sf(data = tracts18, aes(fill = raceContext))+
  scale_fill_manual(values = c("#238A8DFF", "#DCE319FF"),
                    labels = c('<50% white', '>50% white'),
                    name = '')+
  labs(title = 'Majority white and majority\nnon-white neighborhoods, Chicago')+
  mapTheme2()
```

Weather
```{r data setup}
#weather
weather.Panel <- 
  riem_measures(station = "SFO", date_start = "2019-06-01", date_end = "2019-08-31") %>%
  dplyr::select(valid, tmpf, p01i, sknt, vsby)%>% #add visibility in miles
  replace(is.na(.), 0) %>%
    mutate(interval60 = ymd_h(substr(valid,1,13))) %>%
    mutate(week = week(interval60),
           dotw = wday(interval60, label=TRUE)) %>%
    group_by(interval60) %>%
    dplyr::summarize(Temperature = max(tmpf),
              Precipitation = sum(p01i),
              Wind_Speed = max(sknt),
              visibility = max(vsby)) %>%
    mutate(Temperature = ifelse(Temperature == 0, 42, Temperature))
grid.arrange(
  ggplot(weather.Panel, aes(interval60,Precipitation)) + geom_line(color = "#cfe2f3ff", size = 1) + 
  labs(title="Precipitation", x="Hour", y="Precipitation") + plotTheme(),
  ggplot(weather.Panel, aes(interval60,Wind_Speed)) + geom_line(color = "#cfe2f3ff", size = 1) + 
    labs(title="Wind Speed", x="Hour", y="Wind Speed") + plotTheme(),
  ggplot(weather.Panel, aes(interval60,Temperature)) + geom_line(color = "#cfe2f3ff", size = 1) + 
    labs(title="Temperature", x="Hour", y="Temperature") + plotTheme(),
  ggplot(weather.Panel, aes(interval60,Temperature)) + geom_line(color = "#cfe2f3ff", size = 1) + 
    labs(title="Visibility", x="Hour", y="Temperature") + plotTheme(),
  top="Weather Data - San Francisco SFO - Summer 2019")
```

Joining all to one
```{r data setup}
dat_all <- 
  left_join(as.data.frame(dat_census), nn_and_dummy, by=c("POST_ID", "dotw"))

# Parking count per day
dat_all <- dat_all %>%
  mutate(pk_Count = pk_Count/4)
```


```{r data setup}
dat_all$cat_age <- ifelse(dat_all$Med_Age <= 35.9, "1QU", ifelse(dat_all$Med_Age > 35.9 & dat_all$Med_Age <= 37.3, "2QU", ifelse(dat_all$Med_Age > 37.3 & dat_all$Med_Age <= 41.9, "3QU", "4QU"))) #categorize age

dat_all$cat_inc <- ifelse(dat_all$Med_Inc <= 63808, "1QU", ifelse(dat_all$Med_Inc > 63808 & dat_all$Med_Inc <= 98531, "2QU", ifelse(dat_all$Med_Inc > 98531 & dat_all$Med_Inc <= 141588, "3QU", "4QU"))) #categorize income
```

```{r data setup}
#Create time lags
ride.panel <- 
  ride.panel %>% 
  arrange(start_station, interval60) %>% 
  mutate(lagHour = dplyr::lag(Trip_Count,1),
         lag2Hours = dplyr::lag(Trip_Count,2),
         lag3Hours = dplyr::lag(Trip_Count,3),
         lag4Hours = dplyr::lag(Trip_Count,4),
         lag12Hours = dplyr::lag(Trip_Count,12),
         lag1day = dplyr::lag(Trip_Count,24),
         holiday = ifelse(yday(interval60) == 148,1,0)) %>%
  mutate(day = yday(interval60)) 
```


Exploratory plots 
## Distribution of parking posts
```{r data setup}
#---------Plot 1 ------------------
mondays <- 
  mutate(ride.panel,
         monday = ifelse(dotw == "Mon" & hour(interval60) == 1,
                         interval60, 0)) %>%
  filter(monday != 0) 

rbind(
  mutate(ride.Train, Legend = "Training"), 
  mutate(ride.Test, Legend = "Testing")) %>%
  group_by(Legend, interval60) %>% 
  summarize(Trip_Count = sum(Trip_Count)) %>%
  ungroup() %>% 
  ggplot(aes(interval60, Trip_Count, colour = Legend)) + geom_line() +
  geom_vline(data = mondays, aes(xintercept = monday)) +
  scale_colour_manual(values = palette2) +
  labs(title="Rideshare trips by week in Philly: October 8th - November 11st, 2019",
       x="Day", y="Trip Count") +
  plotTheme() + theme(panel.grid.major = element_blank())


#--------------plot 2---------------

ggplot()+
  geom_sf(data = phl.census)+
  geom_point(data = dat_census %>%
               group_by(start_station, start_lat, start_lon, week)%>%
               tally(),
             aes(x=start_lon, y = start_lat, color = n), 
             fill = "transparent", alpha = 0.8, size = 1)+
  scale_colour_viridis(direction = -1,
                       discrete = FALSE, option = "D")+
  ylim(min(dat_census$start_lat), max(dat_census$start_lat))+
  xlim(min(dat_census$start_lon), max(dat_census$start_lon))+
  facet_grid(~week)+
  labs(title="Sum of rideshare trips by station and week",
       subtitle = "Philadelphia, October 8th - November 11st, 2019")+
  mapTheme()

#---------------plot 3----------------------------
ggplot(dat_census %>% mutate(hour = hour(start_time)))+
  geom_freqpoly(aes(hour, color = dotw), binwidth = 1)+
  labs(title="Bike share trips in Philadelphia",
       subtitle = "October 8th - November 11st, 2019",
       x="Hour", 
       y="Trip Counts")+
  plotTheme()

#---------------plot 4---------------------------
ggplot(dat_census %>% 
         mutate(hour = hour(start_time),
                weekend = ifelse(dotw %in% c("Sun", "Sat"), "Weekend", "Weekday")))+
  geom_freqpoly(aes(hour, color = weekend), binwidth = 1)+
  labs(title="Bike share trips in Philadelphia - weekend vs weekday",
       subtitle = "October 8th - November 11st, 2019",
       x="Hour", 
       y="Trip Counts")+
  plotTheme()




# count by post per day
ggplot(post_panel.sf, 
       aes(x=(pk_Count/28)))+ 
  geom_histogram(fill = "#cfe2f3ff")+ 
  scale_y_continuous("Frequency") + 
  scale_x_continuous("Count") + 
  labs(caption="Figure X. Histogram of average count by meter per day")

# logged count by post per day
ggplot(post_panel.sf, 
       aes(x=pk_Count/28))+ 
  geom_histogram(fill = "#cfe2f3ff")+ 
  scale_y_continuous("Frequency") + 
  scale_x_log10("Log of Count") + 
  labs(caption="Figure X. Histogram of average log of count by meter per day")
```

## Spatial Distribution
```{r data setup}
post_panel.sf <- post_panel.sf %>%
  mutate(LONGITUDE = unlist(map(geometry, 1)),
         LATITUDE = unlist(map(geometry, 2)))
ggplot()+
  geom_sf(data = SFTracts %>%
            st_transform(crs="+proj=longlat +crs = 'EPSG:6339'"), colour = '#efefef')+
  geom_point(data = post_panel.sf,
             aes(x=LONGITUDE, y = LATITUDE, color = (pk_Count/28)), 
             fill = "transparent",  size = 0.2)+
  scale_colour_viridis(discrete = FALSE, option = "D",
                       name="Average count \nper day")+
  labs(title="Parking Sessions per day by post,\nSan Francisco, July 4 - August 4, 2017",caption = "Figure X") +
  mapTheme()
```

## Exploring Time
```{r data setup}
study.panel.plot <- dat_all %>%
               group_by(POST_ID, dotw, LONGITUDE, LATITUDE) %>%
               tally()
ggplot(study.panel.plot)+
  geom_col(aes(dotw, n/4), fill = "#cfe2f3ff", size = 1.25)+
  labs(title="Average Parking Sessions by Day of Week,\nSan Francisco, July 4 - August 1, 2017",
       x="Day of Week", 
       y="Number of Sessions")+
  plotTheme()
```

```{r data setup}
# plot map by day of the week
ggplot()+
  geom_sf(data = SFTracts %>%
            st_transform(crs="+proj=longlat +crs = 'EPSG:6339'"), colour = '#efefef')+
  geom_point(data = study.panel.plot,
             aes(x=LONGITUDE, y = LATITUDE, color = n/4), 
             fill = "transparent",  size = 1)+
  scale_colour_viridis(discrete = FALSE, option = "D",
                       name="Count")+
  facet_grid(~ dotw)+
  labs(title="Average Parking Sessions Count by Day of Week,\nSan Francisco, July 4 - August 1, 2017") +
  mapTheme()
```

```{r data setup}
ggplot(parkingsample %>% mutate(hour = hour(SESSION_END_DT)))+
  geom_freqpoly(aes(hour, color = dotw), binwidth = 1, size = 1)+
  labs(title="Parking Sessions by Day of the Week,\nSan Francisco, July 4 - August 4, 2017",
       x="Day of the Week", 
       y="Session Counts",caption = "Figure X")+
  plotTheme()
```






```{r data setup}

```

Modeling
Occupancy 30 min prior, 60 min prior, same period previous day, distance from downtown, count of medical offices within 300 meters, count of businesses within 300 meters, count of bars and restaurants within 300 m, count of grocery store and markets 
```{r data setup}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
